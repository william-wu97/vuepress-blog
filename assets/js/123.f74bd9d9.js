(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{512:function(t,s,a){"use strict";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("本文转载自："),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/302530881",target:"_blank",rel:"noopener noreferrer"}},[t._v("actions自动化：vuepress构建，github同步gitee，giteepage部署"),a("OutboundLink")],1)])]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#说明"}},[t._v("说明")])]),a("li",[a("a",{attrs:{href:"#使用-github-actions"}},[t._v("使用 github actions")])]),a("li",[a("a",{attrs:{href:"#完整actions代码"}},[t._v("完整actions代码")])]),a("li",[a("a",{attrs:{href:"#针对每个job的单独说明"}},[t._v("针对每个job的单独说明")]),a("ul",[a("li",[a("a",{attrs:{href:"#vuepress自动构建及github-page部署：build-and-deploy"}},[t._v("vuepress自动构建及github page部署：build-and-deploy")])]),a("li",[a("a",{attrs:{href:"#同步githubpage至giteepage：sync"}},[t._v("同步githubpage至giteepage：sync")])]),a("li",[a("a",{attrs:{href:"#giteepage自动部署：reload-pages"}},[t._v("giteepage自动部署：reload-pages")])])])]),a("li",[a("a",{attrs:{href:"#鸣谢"}},[t._v("鸣谢")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[t._v("#")]),t._v(" 说明")]),t._v(" "),a("p",[t._v("将vuepress博客的本地构建过程转移到github-actions中，同时支持将构建结果自动部署到gitee上，且可以自动更新gitee pages。")]),t._v(" "),a("p",[t._v("使用此action后你将不再需要关心博客构建的问题，只需要在本地将文档写好后，push到仓库。剩下的构建以及部署交给，github actions就好了。")]),t._v(" "),a("p",[t._v("既节省了本地空间，又减少了操作步骤。")]),t._v(" "),a("h2",{attrs:{id:"使用-github-actions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-github-actions"}},[t._v("#")]),t._v(" 使用 github actions")]),t._v(" "),a("p",[t._v("如果你是第一次使用此工具可以参考官方介绍"),a("a",{attrs:{href:"https://github.com/features/actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("github-actions"),a("OutboundLink")],1),t._v("，也可以参考"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("阮一峰-GitHub Actions 入门教程"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"完整actions代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#完整actions代码"}},[t._v("#")]),t._v(" 完整actions代码")]),t._v(" "),a("p",[t._v("此处假设你已经掌握了github actions的基本使用方法，如果你不清楚如何使用已下代码请参看上面关于如何使用github actions的内容。下面会对代码内部的参数做详细的介绍")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" A TO A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("GH_PAGES\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("push"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build-and-deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@master\n\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Build and Deploy\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jenkey2011/vuepress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deploy@master\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ACCESS_TOKEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.ACCESS_TOKEN "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 你要操作的目标仓库")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("TARGET_REPO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" linzowo/linzowo.github.io\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建结果存储的分支")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("TARGET_BRANCH")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh_pages\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 要使用的构建命令")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("BUILD_SCRIPT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yarn "),a("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(" yarn build\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建结果存储目录")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("BUILD_DIR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" docs/.vuepress/dist/\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("needs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" build"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("and"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deploy\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sync to Gitee\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" wearerequired/git"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SSH_PRIVATE_KEY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_RSA_PRIVATE_KEY "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 来源仓库")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source-repo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git@github.com:linzowo/linzowo.github.io.git"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目标仓库")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("destination-repo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git@gitee.com:linzowo/linzowo.git"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("reload-pages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("needs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sync\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" reload\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mizuka"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("wu/gitee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@v1.0.0\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("repository")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" linzowo/linzowo\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_COOKIE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh_pages\n")])])]),a("h2",{attrs:{id:"针对每个job的单独说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#针对每个job的单独说明"}},[t._v("#")]),t._v(" 针对每个job的单独说明")]),t._v(" "),a("h3",{attrs:{id:"vuepress自动构建及github-page部署：build-and-deploy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vuepress自动构建及github-page部署：build-and-deploy"}},[t._v("#")]),t._v(" "),a("strong",[t._v("vuepress自动构建及github page部署：build-and-deploy")])]),t._v(" "),a("p",[t._v("此actions来源"),a("a",{attrs:{href:"https://github.com/jenkey2011/vuepress-deploy/blob/master/README.zh-CN.md#step-by-step-guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuepress-deploy"),a("OutboundLink")],1),t._v(",如果在配置中有不清楚的部分可以参考该项目的文档。下面将对其中模糊的部分进行说明。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("关键词")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("secrets.")]),t._v(" "),a("td",[t._v("在项目的设置中有一个Secrets选项下面可以存储一些常用值，这些值在actions中可以访问")])]),t._v(" "),a("tr",[a("td",[t._v("secrets.ACCESS_TOKEN")]),t._v(" "),a("td",[t._v("此secrets下存储的是你账户的token ===> token创建步骤：点击你的头像 > Settings > Developer settings > Personal access tokens > Generate new token. 权限至少要勾选"),a("code",[t._v("repo")]),t._v("，不清楚的，直接无脑全选就行~ 问题不大，不要慌。 ===> 创建完成后将生成的token保存下来，在项目secrets下创建ACCESS_TOKEN将你生成的token存入其中就好了")])])])]),t._v(" "),a("h3",{attrs:{id:"同步githubpage至giteepage：sync"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同步githubpage至giteepage：sync"}},[t._v("#")]),t._v(" "),a("strong",[t._v("同步githubpage至giteepage：sync")])]),t._v(" "),a("p",[t._v("此actions来源"),a("a",{attrs:{href:"https://github.com/wearerequired/git-mirror-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("Git Mirror Action"),a("OutboundLink")],1),t._v(",如果在配置中有不清楚的部分可以参考该项目的文档。下面将对其中模糊的部分进行说明。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("关键词")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("secrets.")]),t._v(" "),a("td",[t._v("在项目的设置中有一个Secrets选项下面可以存储一些常用值，这些值在actions中可以访问")])]),t._v(" "),a("tr",[a("td",[t._v("secrets.GITEE_RSA_PRIVATE_KEY")]),t._v(" "),a("td",[t._v("此secrets下存储的是你常用电脑的ssh私钥 ===> 如果你不知道如何生成ssh，参考此教程"),a("a",{attrs:{href:"%5Bhttps://git-scm.com/book/zh/v2/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84-Git-%E7%94%9F%E6%88%90-SSH-%E5%85%AC%E9%92%A5%5D(https://git-scm.com/book/zh/v2/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84-Git-%E7%94%9F%E6%88%90-SSH-%E5%85%AC%E9%92%A5)"}},[t._v("生成 SSH 公钥")]),t._v("，生成对应的ssh公钥后。进入.ssh文件夹中获取id_rsa文件（注意此处的id_rsa文件是无后缀的）中的值。将此值存入GITEE_RSA_PRIVATE_KEY即可。 ===> 完成这一步后我们需要去gitee上存储对应的公钥 ===> 进入gitee ==> 点击头像 ==> 点击设置 ==> 找到安全设置 ==> 找到ssh公钥 ==> 获取.ssh文件夹中id_rsa.pub文件中的值。使用此值添加到账户的公钥中")])])])]),t._v(" "),a("h3",{attrs:{id:"giteepage自动部署：reload-pages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#giteepage自动部署：reload-pages"}},[t._v("#")]),t._v(" "),a("strong",[t._v("giteepage自动部署：reload-pages")])]),t._v(" "),a("p",[t._v("这个actions是为了解决giteepage仓库更新后不能自动部署的问题。此actions来源"),a("a",{attrs:{href:"https://github.com/mizuka-wu/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitee-pages-action"),a("OutboundLink")],1),t._v(",如果在配置中有不清楚的部分可以参考该项目的文档。下面将对其中模糊的部分进行说明。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("关键词")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("secrets.")]),t._v(" "),a("td",[t._v("在项目的设置中有一个Secrets选项下面可以存储一些常用值，这些值在actions中可以访问")])]),t._v(" "),a("tr",[a("td",[t._v("secrets.GITEE_COOKIE")]),t._v(" "),a("td",[t._v("此secrets下存储的是你已经登录gitee后更新pages的时候那个rebuild请求中的值。具体操作步骤我已经在"),a("a",{attrs:{href:"https://github.com/linzowo/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitee-pages-action"),a("OutboundLink")],1),t._v("做了详细记录。可以参考其进行配置")])])])]),t._v(" "),a("h2",{attrs:{id:"鸣谢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#鸣谢"}},[t._v("#")]),t._v(" 鸣谢")]),t._v(" "),a("p",[t._v("感谢您的阅读，如果此文档对您有所帮助，我也十分高兴。")]),t._v(" "),a("p",[t._v("同时感谢一下开源作者的贡献")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/jenkey2011",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jenkey2011"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/wearerequired",target:"_blank",rel:"noopener noreferrer"}},[t._v("required"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/mizuka-wu",target:"_blank",rel:"noopener noreferrer"}},[t._v("Edward Mizuka"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);